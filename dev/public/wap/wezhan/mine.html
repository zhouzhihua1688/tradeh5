<!DOCTYPE html>
<html lang="en">

<head>
    <!--<meta charset="GBK">-->
    <meta charset="utf8">
    <title>我的</title>
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="../css/wezhan/base_wezhan.css">
    <link rel="stylesheet" type="text/css" href="../css/wezhan/welfare.css?1">
    <link rel="stylesheet" type="text/css" href="../css/base.css">
    <script type="text/javascript" src="/tradeh5/newWap/base/js/baseHead.js"></script>
    <style>
        .side-right { position: fixed; right: 0;  bottom:20%;z-index:99;display:none;}
  		.click_hide{height:.8rem;width:100%;bottom:.25rem;position:absolute}
        .mine_head{width:100%;height:10.05rem;background: url('../images/wezhan/mineHead.png') no-repeat;background-size: 100% 100%;} 
        .mine_head .portrait{width:3.0rem;height:3.0rem;margin:0 auto;border-radius:50px;padding-top:1rem;}
        .mine_head .portrait img{border-radius:50px;}
        .mine_head .name{font-size:0.9rem;color:#fff;margin:0 auto;text-align:center;padding-top:0.2rem;}
        .mine_head .member{font-size: 0.55rem; color:#fe7e01;text-align:center;height:1.375rem;line-height:1.375rem;padding-left:0.75rem;}
        .mine_head .tips{font-size:0.65rem;color:#fff;text-align:center;padding-left:1rem;padding-top:0.7rem;} 
        .topDiv{width:100%;height:1.5rem;background: #fff;border-radius:10px 10px 0 0;margin-top:-0.5rem;}
        .infoList{width:100%;height:2.5rem;border-bottom:1px solid #eee;background:#fff;display: flex;justify-content: space-between;align-items: center;}
        .infoList div:nth-of-type(1){width:40%;font-size:0.75rem;color:#000;padding:0 0.75rem;}
        .infoList div:nth-of-type(2){width:60%;font-size:0.75rem;color:#000;padding:0 0.75rem;}
        .infoList .left img{width:0.85rem;height:0.75rem;vertical-align: middle}
        .infoList .right img{width:0.4rem;height:0.75rem;vertical-align: middle;display: inline-block;margin-top:-0.1rem;}

        .Bomb-box2{
            z-index: 10000;
            display: none;
            position: fixed;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            top: 0;
            left: 0;
            text-align: center;
        }

        .Bomb-box2 .Bomb-box-main2{
            position: absolute;
            left: 50%;
            top: 50%;
            width: 15rem;
            background-color: #fff;
            border-radius: 0.3rem;
            -webkit-transform: translate(-50%, -50%);
            -moz-transform: translate(-50%, -50%);
            -ms-transform: translate(-50%, -50%);
            -o-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
        }
        .Bomb-box2 .Bomb-box-content2 p {
            text-align: center;
            line-height: 1rem;
        }
        .Bomb-box2 .Bomb-box-ok2 {
            display: block;
            width: 13.5rem;
            height: 2rem;
            line-height: 2rem;
            text-align: center;
            color: #0070fa;
            font-size: 0.75rem;
            border-top: solid 0.025rem #eee;
            margin: 0 auto;
        }
        #unbound{width:6.5rem;height:2.5rem;display: inline-block;font-size:0.75rem;line-height:2.5rem}
        #noUnbound{width:6.5rem;height:2.5rem;display: inline-block;border-left:1px solid #eee;font-size:0.75rem;line-height:2.5rem}
    </style>
</head>

<body style="background: #f6f6f6">
    <div class="main"  id="panel">
    	<div class="side-right" id="side-right">
        </div>
        <div class="mine_head">
            <div class="portrait"><img src="../images/wezhan/portrait.png" alt=""></div>
            <div class="name"></div>
            <div class="member"></div>
            <div class="tips">现金宝账户由众安保险提供安全保障</div>
        </div>
        <div class="topDiv"></div>
        <a href="../userInfo/parfectInfo.html" style="width:100%;display:inline-block;color: #000">
            <div class="infoList">
                <div class="left">
                    <img src="../images/wezhan/count.png" alt="">
                    <span>账户信息</span>
                </div>
                <div class="right">                    
                        <span class="tel"></span>
                        <img src="../images/wezhan/arrow_r_black.png" alt="">                  
                </div>   
            </div>
        </a>
        <a href="../card/manage_card.html" style="width:100%;display:inline-block">
            <div class="infoList">
                <div class="left">
                    <img src="../images/wezhan/card.png" alt="">
                    <span>银行卡管理</span>
                </div>
        
                <div class="right">   
                    <span></span>
                    <img src="../images/wezhan/arrow_r_black.png" alt="">  
                </div>
            </div>
        </a> 
        <a href="../common/riskTest.html" style="width:100%;display:inline-block">
            <div class="infoList">
                <div class="left">
                    <img src="../images/wezhan/risk.png" alt="">
                    <span>风险测评</span>
                </div>
                <div class="right">
                    
                        <span></span>
                        <img src="../images/wezhan/arrow_r_black.png" alt="">
                    
                </div>
            </div>
        </a>
        <a href="../assetProof/index.html" style="width:100%;display:inline-block">
            <div class="infoList">
                <div class="left">
                    <img src="../images/wezhan/asset.png" alt="">
                    <span>资产证明</span>
                </div>
                <div class="right">
                    
                    <span></span>
                    <img src="../images/wezhan/arrow_r_black.png" alt="">
                    
                </div>
            </div>
        </a>
        <!-- https://activity.99fund.com/activity-center/act-resources/taskPages/task/wdtfh/index.html -->
       <!--  <div class="infoList">
            <div class="left">
                <img src="../images/wezhan/task.png" alt="">
                <span>任务中心</span>
            </div>
            <div class="right">
                
                <a href="http://appuat.99fund.com.cn:7081/activity-center/act-resources/taskPages/task/wdtfh/index.html" style="width:100%;display:inline-block">
                    <span></span>
                    <img src="../images/wezhan/arrow_r_black.png" alt="">
                </a>
            </div>
        </div> -->
        <a href="welfare.html" style="width:100%;display:inline-block">
            <div class="infoList">
                <div class="left">
                    <img src="../images/wezhan/task.png" alt="">
                    <span>领取福利</span>
                </div>
                <div class="right">
                    
                    <span></span>
                    <img src="../images/wezhan/arrow_r_black.png" alt="">
                    
                </div>
            </div>
        </a>
        <a href="subscribeMgmt.html" style="width:100%;display:inline-block">
            <div class="infoList">
                <div class="left">
                    <img src="../images/wezhan/subscribe.png" alt="">
                    <span>订阅管理</span>
                </div>
                <div class="right">
                    
                    <span></span>
                    <img src="../images/wezhan/arrow_r_black.png" alt="">
                    
                </div>
            </div>
        </a>
        <div class="infoList relieve" style="display:none;">
            <div class="left">
                <img src="../images/wezhan/relieve.png" alt="">
                <span>解除账号绑定</span>
            </div>
            <div class="right">
                <span></span>
                <img src="../images/wezhan/arrow_r_black.png" alt="">
            </div>
        </div>
    </div>
	
    <div class="footer_btn">
        <a href="service.html">
            <img src="../images/wezhan/footer_01.png" alt="" >
            <span>服务</span>
        </a>
        <a href="viewPoint.html">
            <img src="../images/wezhan/footer_02.png" alt="">
            <span>观点</span>
        </a>
        <a href="javascript:;">
            <img src="../images/wezhan/footer4.png" alt="">
            <span class="active_color">我的</span>
        </a>
    </div>
    <div class="Bomb-box">
        <div class="Bomb-box-main">
            <p class="Bomb-box-tips"  style="padding-top: 0.75rem;"></p>
            <div class="Bomb-box-content">
                <p class="text-center"></p>
            </div>
            <a class="Bomb-box-ok" href="javascript:;">确定</a>
        </div>
    </div>

    <div class="Bomb-box2">
        <div class="Bomb-box-main2">
            <p class="Bomb-box-tips2"  style="padding-top: 0.75rem;"></p>
            <div class="Bomb-box-content2" style="padding:0.75rem">
                <p class="text-center2" style="text-align: justify">解除账号绑定后，您的账户交易变动信息将无法在第一时间得到通知。建议保持绑定状态。汇添富基金将保护您的资金及信息安全。</p>
            </div>
            <a class="Bomb-box-ok2" href="javascript:;" id="unbound" onclick="unbind()">继续解绑</a>
            <a class="Bomb-box-ok2" href="javascript:;" id='noUnbound'>暂不解绑</a>
        </div>
    </div>

    <script src="../js/lib/jquery.3.4.1.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="../js/lib/weixin.js"></script>
	<script src="/tradeh5/newWap/base/js/utils.js"></script>
     <script type="text/javascript" src="../js/common.js"></script>
	<script src="../js/common.js?20210302" type="text/javascript"></script>
    <script type="text/javascript" src="../js/lib/phone-size.js"></script>
	<script type="text/javascript" src="https://static.99fund.com/js/stat/stat_new.js"></script>
	<script>

        var sys = "1";
        if(App.getCookie("channelCode") == "tfhwx"){
            sys = "2";
        } 
        var channelCode = App.getCookie("channelCode");
        if(App.isEmpty(channelCode)){
            channelCode = App.getUrlParam("channelCode");
        }
// 判断是否绑定
        if(HTF.isWeixin()){
            
            var ssoCookie = HTF.getCookie("sso_cookie");
      
            if (HTF.isNotBlank(ssoCookie)) {//有登录态

                var url = "/mobile-bff/v1/weixin/queryBindStatus";
                App.get(url, null, function(result){
                    if (result.body != undefined && result.body != null){
                        if(result.body.bindStatus == "1"){//已绑定
                            $(".infoList").show();
                        }else{
                            // window.location.href = '/mobileEC/wap/login/wx_login.html?channelCode='+channelCode+"&unbind=1";
                        }
                    }
                });
            }else{
                //window.location.href = '/mobileEC/wap/login/wx_login.html?channelCode='+channelCode;
            }
        }

        // var bindStatus=""
        // var url = "/mobile-bff/v1/weixin/queryBindStatus?system="+sys;
        // App.get(url, null, function(result){
        //     if (result.body != undefined && result.body != null){
        //         console.log(result.body);
        //         bindStatus=result.body.bindStatus;
        //         if(result.body.bindStatus == "1"){//已绑定
        //             $(".infoList").show();
        //         }
        //     }
        // });

        // $(".mine_head .name").text(str[0]+"*"+str[str.length-1]);
         
//查询基本个人信息。（包含头像）start
        function getAvatarImage(){
            utils.get('/mobile-bff/v1/customerInfo/basic-customer-info', null, function (result) {
                if (result.returnCode == 0) {
                   $(".mine_head .portrait img").attr('src', result.body.buserInfo.avatarImage);//头像
                   // $(".mine_head .name").text(result.body.buserInfo.invnm); //名字
                   processName(result.body.buserInfo.invnm);                  //名字格式化 

                   var tel=result.body.buserInfo.mobileno;                    //获取账户信息号码
                   tel && $(".infoList .tel").text(tel.substr(0,3) + "****" + tel.substr(7));  //电话号中间四位*号显示         
                }else if (result && result.returnCode != 9999) {
                    alert(result.returnMsg)
                }else {
                    alert(result.returnMsg) 
                }
           });
        } 
        getAvatarImage();
//查询基本个人信息。（包含头像）end
        function processName(str){   //截取隐藏名字(*号)
                  if(null != str && str != undefined){
                    let star = '' //存放名字中间的*
                    //名字是两位的就取姓名首位+*
                    if(str.length <= 2){
                        $(".mine_head .name").text(str.substring(0,1)+"*");
                    
                    } else {
                      for (var i = 0; i < str.length-2; i++) {
                        star= star + '*'
                      }
                       $(".mine_head .name").text(str.substring(0,1)+ star + str.substring(str.length-1,str.length));
                    }
                  }
                }
        


//会员中心：会员信息、添富币统计。start
        function getMember(){   //获取会员级别
            utils.get('/reward/v1/point/cust/points', null, function (result) {
                if (result.returnCode == 0) {
                   $(".mine_head .member").text(result.body.gradeName); 
                }else if (result && result.returnCode != 9999) {
                    alert(result.returnMsg)
                }else {
                    alert(result.returnMsg)
                }
           });
        }
        getMember();
//会员中心：会员信息、添富币统计。end


// 解除账号绑定 start
        var switchFlag = false;
        $(".relieve").click(function(event) {
            // if(!switchFlag){
            //     $(".Bomb-box2").show();
            // }
            $(".Bomb-box2").show();
            // else{
            //     App.post(App.projectNm + "/account/logout", "", null, function (result) {
            //         App.clearSession();
            //         window.location = "../login/wx_login.html?channelCode="+channelCode+"&unbind=1";
            //     });
            // }
            
        });
        $("#noUnbound").click(function(event) {
            $(".Bomb-box2").hide();
        });  

        // function unbind(){
        //     if (switchFlag) {
        //         //跳转至
        //         window.location = App.loginPage + "?referUrl=" + encodeURIComponent(window.location.href);
        //     } else {
        //         $(".Bomb-box2").hide();
        //         var url = "/mobile-bff/v1/weixin/weixinUnbind?system="+sys;
        //         App.get(url, null, function(result){
        //             if (result.body != undefined && result.body != null){
        //                 var res = result.body;
        //                 console.log("res",res);
        //                 // if(res.body.operateRst == "2"){
        //                     // $("#lottery1").show();
        //                     $(".infoList").hide();
        //                     App.post(App.projectNm + "/account/logout", "", null, function (result) {
        //                         App.clearSession();
        //                         window.location = "../login/wx_login.html?channelCode="+channelCode+"&unbind=1";
        //                     });

        //                 // }
        //             }
        //         });
        //         // $(this).removeClass("switch_open").addClass('switch_close');
        //         switchFlag = true;
        //     }
        // } 


        function unbind(){
            var url2 = "/mobile-bff/v1/weixin/weixinUnbind?system="+sys;
            App.get(url2, null, function(result){
                if (result.body != undefined && result.body != null){
                    var res = result.body;
                    if(res){
                        $(".Bomb-box2").hide();
                        $(".infoList").hide();
                        var url = "/mobile-bff/v1/login/login-out";
                        var accessToken = App.getCookie("sso_cookie") ? App.getCookie("sso_cookie").replace(/"/g,'') : "";
                        var data = JSON.stringify({
                            "accessToken": accessToken
                        });
                        App.post(url, data, null, function (result) {
                            var openId = App.getCookie("__openId");
                            var openUid = App.getCookie("__openUid");
                            //清除cookies
                            App.clearSession();
                            App.setCookie("sso_cookie", "", "", "/", ".99fund.com");
                            window.location.href="service.html";
                            // window.location = "../login/wx_login.html?channelCode="+channelCode+"&unbind=1&openId="+openId+"&openUid="+openUid;
                        });
                    }
                }
            });
        }
// 解除账号绑定 end        
	</script>
</body>

</html>